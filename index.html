<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Mentor Premium — ISC</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;background:#f6f7fb;margin:0;padding:20px;color:#0f172a}
    .chkgrid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
    .chk{display:flex;align-items:center;gap:6px;border:1px solid #d0dae6;border-radius:10px;padding:6px;background:#fff}
    .chk input{width:16px;height:16px;accent-color:#1f6feb}
    .plan{border:1px dashed #cfdced;background:#fff;border-radius:10px;padding:10px;margin:10px 0}
  </style>
</head>
<body>
  <h2>Mentor Premium — ISC</h2>
  <label>Nome: <input id="nome"></label><br><br>
  <label>Queixa: <input id="queixa" style="width:60%"></label><br><br>
  <label>Contexto: <input id="contexto" style="width:80%"></label>

  <h3>Anamnese</h3>
  <div class="chkgrid" id="anam">
    <label class="chk"><input type="checkbox" value="TAG"> Ansiedade Generalizada (TAG)</label>
    <label class="chk"><input type="checkbox" value="PANICO"> Crises de Pânico</label>
    <label class="chk"><input type="checkbox" value="BURNOUT"> Burnout</label>
    <label class="chk"><input type="checkbox" value="BORDERLINE"> Borderline</label>
    <label class="chk"><input type="checkbox" value="TOC"> TOC</label>
    <label class="chk"><input type="checkbox" value="TDAH"> TDAH</label>
    <!-- Outros transtornos poderiam continuar aqui -->
  </div>

  <p>
    <button id="gerar">Aplicar & Sugerir Técnicas</button>
    <button id="pdf">Gerar PDF</button>
  </p>

  <div id="out" class="plan">Preencha e clique em aplicar.</div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const $=q=>document.querySelector(q);
    const $$=q=>Array.from(document.querySelectorAll(q));
    function sampleUpTo(a,n){
      const x=[...a];for(let i=x.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));[x[i],x[j]]=[x[j],x[i]];
      }return x.slice(0,Math.min(n,x.length));
    }
    const CATALOGO={
      "TAG":[
        {t:"Diário de preocupações",what:"Delimitar horário fixo",how:["20min/dia","Anotar e adiar"],why:"Reduz ruminação",hidden:"Necessidade de controle",kpi:["Menos preocupações fora do tempo"]},
        {t:"Solução de problemas",what:"Transformar em ação",how:["Definir problema","Plano com prazo"],why:"Reduz ruminação improdutiva",hidden:"Medo de errar",kpi:["Execução de passos"]}
      ],
      "PANICO":[
        {t:"Exposição interoceptiva",what:"Recriar sintomas",how:["3x/sem","Respiração 4-4-6"],why:"Reduz medo do corpo",hidden:"Medo de perder controle",kpi:["Menos visitas ao PS"]},
        {t:"Plano de crise",what:"Roteiro de emergência",how:["Grounding 5-4-3-2-1","Rede de apoio"],why:"Aumenta segurança",hidden:"Dependência externa",kpi:["Uso menor de benzodiazepínicos"]}
      ],
      "BURNOUT":[
        {t:"Ritmo & fronteiras",what:"Redefinir limites",how:["Pausas programadas","Fim de expediente"],why:"Reduz sobrecarga",hidden:"Identidade ligada a performance",kpi:["Sono regulado"]}
      ],
      "BORDERLINE":[
        {t:"DBT — TIP",what:"Regulação rápida",how:["Água fria","Exercício curto"],why:"Desativa hiperexcitação",hidden:"Acting-out de dor",kpi:["Menos impulsos autoagressivos"]}
      ],
      "TOC":[
        {t:"EPR",what:"Exposição com prevenção de resposta",how:["Hierarquia de estímulos","Sem ritual"],why:"Habituação",hidden:"Fusão pensamento-ação",kpi:["Menos rituais compulsivos"]}
      ],
      "TDAH":[
        {t:"Blocos de foco",what:"Técnica Pomodoro",how:["25/5 ciclos","3 prioridades"],why:"Melhora executivas",hidden:"Evitação do fracasso",kpi:["Tarefas concluídas"]}
      ]
    };
    function gerar(){
      const nome=$("#nome").value||"Paciente";
      const q=$("#queixa").value||"—";
      const c=$("#contexto").value||"—";
      const mods=$$("#anam input:checked").map(x=>x.value);
      let html=`<div class="plan"><b>Parecer — ${nome}</b><br><b>Queixa:</b> ${q}<br><b>Contexto:</b> ${c}</div>`;
      if(!mods.length){$("#out").innerHTML=html+"<div class='plan'>Marque ao menos um item.</div>";return;}
      for(const m of mods){const esc=sampleUpTo(CATALOGO[m]||[],3);
        for(const b of esc){html+=`<div class='plan'><h4><b>${b.t} (${m})</b></h4>
        <b>O que fazer:</b> ${b.what}<br>
        <b>Como fazer:</b><ul>${(b.how||[]).map(s=>`<li>${s}</li>`).join("")}</ul>
        <b>Por quê:</b> ${b.why}<br>
        <b>Oculto:</b> ${b.hidden}<br>
        <b>Indicadores:</b><ul>${(b.kpi||[]).map(s=>`<li>${s}</li>`).join("")}</ul>
        </div>`;}}
      $("#out").innerHTML=html;
    }
    $("#gerar").addEventListener("click",gerar);
    document.getElementById("pdf").addEventListener("click",()=>{
      const jsPDF=window.jspdf.jsPDF;
      const doc=new jsPDF();doc.setFont("helvetica","normal");doc.setFontSize(12);
      const nome=$("#nome").value||"Paciente";
      const text=$("#out").innerText.split("\n");let y=20;
      for(const L of text){doc.text(L,15,y);y+=8;if(y>280){doc.addPage();y=20;}}
      doc.text(`${nome} • ${(new Date()).toLocaleDateString("pt-BR")}`,15,290);
      doc.save("Parecer-ISC.pdf");
    });
  </script>
</body>
</html>